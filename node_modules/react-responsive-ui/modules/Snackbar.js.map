{"version":3,"sources":["../source/Snackbar.js"],"names":["PureComponent","Component","Snackbar","state","snackbar","status","queue","next","props","minTime","lengthTimeFactor","value","shift","setState","queueSize","length","height","undefined","hiding","duration","content","window","rruiCollapseOnFocusOut","auto_hide_timer","setTimeout","hide","hideAnimationDuration","show","show_next_snack_timeout","clearTimeout","show_snack_timeout","prevProps","push","newValue","receiveNewValue","current","offsetHeight","marginBottom","parseInt","getComputedStyle","anti_lag_timeout","type","style","transform","transition","showCloseButton","close","component","createElement","action","onClick","title","propTypes","shape","oneOfType","string","node","func","object","number","isRequired","bool","defaultProps","Close"],"mappings":"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","file":"Snackbar.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport classNames from 'classnames'\r\nimport createRef from 'react-create-ref'\r\n\r\n// `PureComponent` is only available in React >= 15.3.0.\r\nconst PureComponent = React.PureComponent || React.Component\r\n\r\n// Sits at the bottom of a page and displays notifications\r\nexport default class Snackbar extends PureComponent\r\n{\r\n\tstatic propTypes =\r\n\t{\r\n\t\t// Snackbar value (either a message, or an object)\r\n\t\tvalue : PropTypes.shape\r\n\t\t({\r\n\t\t\t// Notification content.\r\n\t\t\tcontent : PropTypes.oneOfType\r\n\t\t\t([\r\n\t\t\t\tPropTypes.string,\r\n\t\t\t\tPropTypes.node\r\n\t\t\t]),\r\n\r\n\t\t\t// Instead of `content` property one may supply `component` property\r\n\t\t\t// which must be a React component which receives all \"rest\" `value` properties\r\n\t\t\t// and also `hide`property (a function that hides the notification).\r\n\t\t\tcomponent : PropTypes.func,\r\n\r\n\t\t\t// `props` are passed to `component`.\r\n\t\t\tprops : PropTypes.object,\r\n\r\n\t\t\t// If `content` is a `string` then its `length` is calculated automatically.\r\n\t\t\t// Otherwise one may pass `length` manually.\r\n\t\t\t// It's used for calculating notification `duration`.\r\n\t\t\tlength : PropTypes.number,\r\n\r\n\t\t\t// `type` is appended as a BEM modifier to `.rrui__snackbar` CSS class.\r\n\t\t\t// E.g. `.rrui__snackbar--error` for `{ type: \"error\" }`.\r\n\t\t\ttype : PropTypes.string,\r\n\r\n\t\t\t// How long does the notification stay.\r\n\t\t\t// Pass `-1` for it to stay until it's closed manually.\r\n\t\t\tduration : PropTypes.number,\r\n\r\n\t\t\t// (optional)\r\n\t\t\t// Action button on the right side.\r\n\t\t\taction: PropTypes.shape({\r\n\t\t\t\tonClick: PropTypes.func.isRequired,\r\n\t\t\t\ttitle: PropTypes.string.isRequired\r\n\t\t\t}),\r\n\r\n\t\t\t// (optional)\r\n\t\t\t// Set to `true` to show a close button.\r\n\t\t\t// Close button is automatically shown\r\n\t\t\t// when `content` is text and `duration` is `-1`.\r\n\t\t\tclose: PropTypes.bool\r\n\t\t}),\r\n\r\n\t\t// // \"Snack\" showing CSS animation duration.\r\n\t\t// // Is 225 milliseconds by default.\r\n\t\t// showAnimationDuration : PropTypes.number.isRequired,\r\n\r\n\t\t// \"Snack\" hiding CSS animation duration.\r\n\t\t// Is 195 milliseconds by default.\r\n\t\thideAnimationDuration : PropTypes.number.isRequired,\r\n\r\n\t\t// The total display duration (in milliseconds) of a snack\r\n\t\t// is `minTime + message.length * lengthTimeFactor`\r\n\t\tminTime          : PropTypes.number.isRequired,\r\n\t\tlengthTimeFactor : PropTypes.number.isRequired\r\n\t}\r\n\r\n\tstatic defaultProps =\r\n\t{\r\n\t\t// showAnimationDuration : 225,\r\n\t\thideAnimationDuration : 195,\r\n\t\tminTime : 1200,\r\n\t\tlengthTimeFactor : 60\r\n\t}\r\n\r\n\tstate = {}\r\n\r\n\tsnackbar = createRef()\r\n\r\n\tstatus = 'idle'\r\n\tqueue = []\r\n\r\n\tcomponentWillUnmount()\r\n\t{\r\n\t\tclearTimeout(this.auto_hide_timer)\r\n\t\tclearTimeout(this.show_next_snack_timeout)\r\n\t\tclearTimeout(this.show_snack_timeout)\r\n\t}\r\n\r\n\treceiveNewValue(prevProps)\r\n\t{\r\n\t\tconst { value } = this.props\r\n\r\n\t\t// If `value` has changed then push it to the queue.\r\n\t\tif (value && value !== prevProps.value)\r\n\t\t{\r\n\t\t\t// Add the notification to the queue\r\n\t\t\tthis.push(value)\r\n\t\t}\r\n\t}\r\n\r\n\t// Adds a notification to the queue\r\n\tpush(newValue)\r\n\t{\r\n\t\t// Add the notification to the queue\r\n\t\tthis.queue.push(newValue)\r\n\t\tthis.setState({\r\n\t\t\tqueueSize: this.queue.length\r\n\t\t})\r\n\t\t// If the notification queue was empty\r\n\t\t// then kick-start it.\r\n\t\tif (this.status === 'idle') {\r\n\t\t\tthis.next()\r\n\t\t}\r\n\t}\r\n\r\n\t// Displays the next notification in the queue\r\n\tnext = () =>\r\n\t{\r\n\t\tconst {\r\n\t\t\tminTime,\r\n\t\t\tlengthTimeFactor\r\n\t\t} = this.props\r\n\r\n\t\t// Get the next notification from the queue\r\n\t\t// (will be `undefined` if the queue is empty)\r\n\t\tconst value = this.queue.shift()\r\n\r\n\t\t// Reset the notification display\r\n\t\tthis.setState({\r\n\t\t\tvalue,\r\n\t\t\tqueueSize: this.queue.length,\r\n\t\t\theight: undefined,\r\n\t\t\t// wide: undefined,\r\n\t\t\thiding: false\r\n\t\t})\r\n\r\n\t\t// If the queue is empty, then just exit\r\n\t\tif (!value) {\r\n\t\t\tthis.status = 'idle'\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tthis.status = 'active'\r\n\r\n\t\t// `state.show` will be set to `true` later,\r\n\t\t// when the height of the element is measured\r\n\t\t// (which is after it renders)\r\n\r\n\t\tif (value.duration === -1) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t// The total display duration (in milliseconds) of a snack\r\n\t\t// is `minTime + message.length * lengthTimeFactor`\r\n\t\tconst length = typeof value.content === 'string' ? value.content.length : value.length || 0\r\n\t\tconst duration = value.duration || (minTime + length * lengthTimeFactor)\r\n\r\n\t\t// Hide the notification after it expires.\r\n\t\tif (window.rruiCollapseOnFocusOut !== false) {\r\n\t\t\tthis.auto_hide_timer = setTimeout(this.hide, duration)\r\n\t\t}\r\n\t}\r\n\r\n\thide = () =>\r\n\t{\r\n\t\tconst { hideAnimationDuration } = this.props\r\n\r\n\t\t// Start the hiding animation for the notification\r\n\t\tthis.setState({ show: false, hiding: true })\r\n\r\n\t\t// Display the next notification\r\n\t\t// after the currently being hidden one\r\n\t\t// finishes its hiding animation.\r\n\t\tthis.show_next_snack_timeout = setTimeout(this.next, hideAnimationDuration)\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps)\r\n\t{\r\n\t\tlet { height, value } = this.state\r\n\r\n\t\t// If `value` got updated then push it to the list of `queue`.\r\n\t\tthis.receiveNewValue(prevProps)\r\n\r\n\t\t// The notification DOM element has just been rendered\r\n\t\t// which means its dimensions are set by now.\r\n\t\t// Calculate the notification container DOM element height\r\n\t\t// so that the slide-from-bottom animation knows\r\n\t\t// its target Y-position for the CSS `translate` transform.\r\n\t\tif (height === undefined && value)\r\n\t\t{\r\n\t\t\theight = this.snackbar.current.offsetHeight\r\n\t\t\t// const wide = this.snackbar.current.offsetWidth === document.documentElement.clientWidth\r\n\t\t\tconst marginBottom = parseInt(getComputedStyle(this.snackbar.current).marginBottom)\r\n\t\t\tconst anti_lag_timeout = 100 // Otherwise it would jump to fully shown in Chrome when there's a queue of snacks waiting to be shown\r\n\t\t\tthis.setState({\r\n\t\t\t\theight,\r\n\t\t\t\t// wide,\r\n\t\t\t\tmarginBottom\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.show_snack_timeout = setTimeout(() => this.setState({ show: true }), anti_lag_timeout)\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\trender()\r\n\t{\r\n\t\tconst {\r\n\t\t\ttype\r\n\t\t} = this.props\r\n\r\n\t\tconst {\r\n\t\t\tshow,\r\n\t\t\tvalue,\r\n\t\t\theight,\r\n\t\t\t// wide,\r\n\t\t\tmarginBottom,\r\n\t\t\thiding,\r\n\t\t\tqueueSize\r\n\t\t} = this.state\r\n\r\n\t\tconst style = {}\r\n\r\n\t\tif (!show) {\r\n\t\t\t// If no snack is being shown,\r\n\t\t\t// or if a snack is about to be shown,\r\n\t\t\t// then shift it under the screen's bottom border\r\n\t\t\t// to show the slide-from-bottom animation at the next step.\r\n\t\t\tif (height !== undefined) {\r\n\t\t\t\tstyle.transform = `translateY(${height + marginBottom}px)`\r\n\t\t\t}\r\n\t\t\tif (!hiding) {\r\n\t\t\t\tstyle.transition = 'none'\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst showCloseButton = value && (value.close || (typeof value.content === 'string' && value.duration === -1))\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tref={this.snackbar}\r\n\t\t\t\tstyle={style}\r\n\t\t\t\tclassName={classNames(\r\n\t\t\t\t\t'rrui__snackbar',\r\n\t\t\t\t\tvalue && value.type && `rrui__snackbar--${value.type}`, {\r\n\t\t\t\t\t\t'rrui__snackbar--hidden': !show\r\n\t\t\t\t\t}\r\n\t\t\t\t)}>\r\n\r\n\t\t\t\t{/* Render the default content component. */}\r\n\t\t\t\t{value && !value.component &&\r\n\t\t\t\t\t<p className=\"rrui__snackbar__text\">\r\n\t\t\t\t\t\t{value.content}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t}\r\n\r\n\t\t\t\t{/* Render a custom content component. */}\r\n\t\t\t\t{value && value.component &&\r\n\t\t\t\t\tReact.createElement(value.component, {\r\n\t\t\t\t\t\t...value.props,\r\n\t\t\t\t\t\thide: this.hide\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\t{(value && value.action || showCloseButton) &&\r\n\t\t\t\t\t<div className=\"rrui__snackbar__actions\">\r\n\t\t\t\t\t\t{value && value.action &&\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tonClick={value.action.onClick}\r\n\t\t\t\t\t\t\t\tclass=\"rrui__snackbar__action rrui__button-reset\">\r\n\t\t\t\t\t\t\t\t{value.action.title}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{showCloseButton &&\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tonClick={this.hide}\r\n\t\t\t\t\t\t\t\tclassName=\"rrui__snackbar__close rrui__button-reset\">\r\n\t\t\t\t\t\t\t\t<Close/>\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\r\n\t\t\t\t{/* value && value.duration === -1 && */}\r\n\t\t\t\t{queueSize > 0 &&\r\n\t\t\t\t\t<div className=\"rrui__snackbar__count\">\r\n\t\t\t\t\t\t{queueSize + 1}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nfunction Close() {\r\n\treturn (\r\n\t\t<svg className=\"rrui__snackbar__close-icon\" viewBox=\"0 0 100 100\">\r\n\t\t\t<line stroke=\"currentColor\" strokeWidth=\"10\" x1=\"2\" y1=\"2\" x2=\"98\" y2=\"98\"/>\r\n\t\t\t<line stroke=\"currentColor\" strokeWidth=\"10\" x1=\"2\" y1=\"98\" x2=\"98\" y2=\"2\"/>\r\n\t\t</svg>\r\n\t)\r\n}"]}