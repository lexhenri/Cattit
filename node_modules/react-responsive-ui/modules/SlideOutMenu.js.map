{"version":3,"sources":["../source/SlideOutMenu.js"],"names":["Context","PureComponent","Component","ContextAwareSlideoutMenu","slideOutMenu","show","current","hide","props","context","registerMenu","toggleMenu","setTogglerCooldown","getTogglerNode","SlideoutMenu","state","container","onFocusOutRef","toggle","onAfterToggle","onCollapse","onExpand","undefined","listenToTouches","stopListeningToTouches","setState","onKeyDown","event","ctrlKey","altKey","shiftKey","metaKey","keyCode","preventDefault","onFocusOut","window","rruiCollapseOnFocusOut","getContainerNode","menuRef","unregister","isShown","element","menu","anchor","fullscreen","className","children","rest","propTypes","oneOf","isRequired","bool","object","func","style","string","defaultProps"],"mappings":"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","file":"SlideOutMenu.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport classNames from 'classnames'\r\nimport createRef from 'react-create-ref'\r\nimport createContext from 'create-react-context'\r\n\r\nimport { Context as PageAndMenuContext } from './PageAndMenu'\r\nimport OnFocusOutOrTapOutside from './OnFocusOutOrTapOutside'\r\n\r\nexport const Context = createContext()\r\n\r\n// `PureComponent` is only available in React >= 15.3.0.\r\nconst PureComponent = React.PureComponent || React.Component\r\n\r\nexport default class ContextAwareSlideoutMenu extends PureComponent {\r\n\tslideOutMenu = createRef()\r\n\tshow = () => this.slideOutMenu.current.show()\r\n\thide = () => this.slideOutMenu.current.hide()\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<PageAndMenuContext.Consumer>\r\n\t\t\t\t{context => (\r\n\t\t\t\t\t<SlideoutMenu\r\n\t\t\t\t\t\tref={this.slideOutMenu}\r\n\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\tregisterMenu={context.registerMenu}\r\n\t\t\t\t\t\ttoggleMenu={context.toggleMenu}\r\n\t\t\t\t\t\tsetTogglerCooldown={context.setTogglerCooldown}\r\n\t\t\t\t\t\tgetTogglerNode={context.getTogglerNode}/>\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t</PageAndMenuContext.Consumer>\r\n\t\t)\r\n\t}\r\n}\r\n\r\n// const ContextAwareSlideoutMenu = (props) => (\r\n// \t<PageAndMenuContext.Consumer>\r\n// \t\t{context => (\r\n// \t\t\t<SlideoutMenu\r\n// \t\t\t\t{...props}\r\n// \t\t\t\tregisterMenu={context.registerMenu}\r\n// \t\t\t\ttoggleMenu={context.toggleMenu}/>\r\n// \t\t\t)\r\n// \t\t}\r\n// \t</PageAndMenuContext.Consumer>\r\n// )\r\n\r\n// export default ContextAwareSlideoutMenu\r\n\r\n// Swipeable feature example source code:\r\n// https://github.com/mui-org/material-ui/blob/v1-beta/packages/material-ui/src/SwipeableDrawer/SwipeableDrawer.js\r\n\r\n// A slideout menu.\r\nclass SlideoutMenu extends PureComponent\r\n{\r\n\tstatic propTypes =\r\n\t{\r\n\t\tanchor : PropTypes.oneOf([\r\n\t\t\t'left',\r\n\t\t\t'right',\r\n\t\t\t'top',\r\n\t\t\t'bottom'\r\n\t\t]).isRequired,\r\n\r\n\t\t// isOpen : PropTypes.bool.isRequired,\r\n\r\n\t\tfullscreen : PropTypes.bool.isRequired,\r\n\r\n\t\t// A result of `React.createRef()`.\r\n\t\t// Will be focused when the menu is opened.\r\n\t\tmenuRef : PropTypes.object,\r\n\r\n\t\tonCollapse : PropTypes.func,\r\n\t\tonExpand : PropTypes.func,\r\n\r\n\t\ttoggleMenu: PropTypes.func.isRequired,\r\n\t\tregisterMenu: PropTypes.func.isRequired,\r\n\t\tsetTogglerCooldown: PropTypes.func.isRequired,\r\n\t\tgetTogglerNode: PropTypes.func.isRequired,\r\n\r\n\t\t// CSS style object\r\n\t\tstyle : PropTypes.object,\r\n\r\n\t\t// CSS class\r\n\t\tclassName : PropTypes.string\r\n\t}\r\n\r\n\tstatic defaultProps =\r\n\t{\r\n\t\t// isOpen : false,\r\n\t\tanchor : 'left',\r\n\t\tfullscreen : false\r\n\t}\r\n\r\n\tstate = {\r\n\t\t// Should not be `undefined` because it's compared to\r\n\t\t// `show` argument in `.toggle(show)`.\r\n\t\tshow: false\r\n\t}\r\n\r\n\tcontainer = createRef()\r\n\tonFocusOutRef = createRef()\r\n\r\n\tcomponentDidMount()\r\n\t{\r\n\t\tconst { registerMenu, menuRef } = this.props\r\n\t\tconst { show } = this.state\r\n\r\n\t\tthis.unregister = registerMenu\r\n\t\t({\r\n\t\t\thide    : () => this.setState({ show: false }),\r\n\t\t\ttoggle  : this.toggle,\r\n\t\t\tisShown : () => this.state.show,\r\n\t\t\telement : () => this.container.current,\r\n\t\t\tmenu    : () => menuRef ? menuRef.current : this.container.current\r\n\t\t})\r\n\r\n\t\t// // Hide on `Back`/`Forward` navigation.\r\n\t\t// window.addEventListener('popstate', this.hide)\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.unregister()\r\n\t\t// window.removeEventListener('popstate', this.hide)\r\n\t}\r\n\r\n\ttoggle = (show, onAfterToggle) => {\r\n\t\tconst { onCollapse, onExpand } = this.props\r\n\t\tif (show === this.state.show) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (show === undefined) {\r\n\t\t\tshow = !this.state.show\r\n\t\t}\r\n\t\tif (show) {\r\n\t\t\tthis.onFocusOutRef.current.listenToTouches()\r\n\t\t\tonExpand && onExpand()\r\n\t\t} else {\r\n\t\t\tthis.onFocusOutRef.current.stopListeningToTouches()\r\n\t\t\tonCollapse && onCollapse()\r\n\t\t}\r\n\t\tthis.setState({ show }, onAfterToggle)\r\n\t}\r\n\r\n\thide = () => {\r\n\t\tconst { toggleMenu } = this.props\r\n\t\tconst { show } = this.state\r\n\t\tif (show) {\r\n\t\t\ttoggleMenu()\r\n\t\t}\r\n\t}\r\n\r\n\tonKeyDown = (event) => {\r\n\t\tconst { toggleMenu } = this.props\r\n\t\tif (event.ctrlKey || event.altKey || event.shiftKey || event.metaKey) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tswitch (event.keyCode) {\r\n\t\t\t// Collapse on \"Escape\".\r\n\t\t\tcase 27:\r\n\t\t\t\tevent.preventDefault()\r\n\t\t\t\treturn toggleMenu()\r\n\t\t}\r\n\t}\r\n\r\n\t// Hide the menu on focus out.\r\n\tonFocusOut = () => {\r\n\t\tconst { toggleMenu, setTogglerCooldown } = this.props\r\n\t\t// `window.rruiCollapseOnFocusOut` can be used\r\n\t\t// for debugging expandable contents.\r\n\t\tif (window.rruiCollapseOnFocusOut !== false) {\r\n\t\t\ttoggleMenu(false)\r\n\t\t\tsetTogglerCooldown()\r\n\t\t}\r\n\t}\r\n\r\n\tgetContainerNode = () => this.container.current\r\n\r\n\trender()\r\n\t{\r\n\t\tconst {\r\n\t\t\tanchor,\r\n\t\t\tfullscreen,\r\n\t\t\tgetTogglerNode,\r\n\t\t\tclassName,\r\n\t\t\tchildren,\r\n\t\t\t// rest\r\n\t\t\tmenuRef,\r\n\t\t\tonExpand,\r\n\t\t\tonCollapse,\r\n\t\t\ttoggleMenu,\r\n\t\t\tregisterMenu,\r\n\t\t\tsetTogglerCooldown,\r\n\t\t\t...rest\r\n\t\t} = this.props\r\n\r\n\t\tconst { show } = this.state\r\n\r\n\t\t// ARIA menu notes:\r\n\t\t// https://www.w3.org/TR/wai-aria-practices/examples/menu-button/menu-button-links.html\r\n\r\n\t\t// `tabIndex=\"-1\"` is for calling `this.container.current.focus()`\r\n\t\t// when no `menuRef` is supplied.\r\n\r\n\t\t// `<OnFocusOutOrTapOutside/>` sets `onBlur` on the `<div/>`.\r\n\t\treturn (\r\n\t\t\t<OnFocusOutOrTapOutside\r\n\t\t\t\tref={this.onFocusOutRef}\r\n\t\t\t\tgetContainerNode={this.getContainerNode}\r\n\t\t\t\tgetTogglerNode={getTogglerNode}\r\n\t\t\t\tonFocusOut={this.onFocusOut}\r\n\t\t\t\tlistenToTouches={false}>\r\n\t\t\t\t<div\r\n\t\t\t\t\t{ ...rest }\r\n\t\t\t\t\tref={ this.container }\r\n\t\t\t\t\taria-hidden={ !show }\r\n\t\t\t\t\ttabIndex={ -1 }\r\n\t\t\t\t\tonKeyDown={ this.onKeyDown }\r\n\t\t\t\t\tclassName={ classNames(\r\n\t\t\t\t\t\tclassName,\r\n\t\t\t\t\t\t/* Developers can define custom `:focus` style for the slideout menu. */\r\n\t\t\t\t\t\t/* (or better add `menuRef` property pointing to a component having `.focus()` method). */\r\n\t\t\t\t\t\t'rrui__outline',\r\n\t\t\t\t\t\t'rrui__slideout-menu',\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t'rrui__slideout-menu--left'       : anchor === 'left',\r\n\t\t\t\t\t\t\t'rrui__slideout-menu--right'      : anchor === 'right',\r\n\t\t\t\t\t\t\t'rrui__slideout-menu--top'        : anchor === 'top',\r\n\t\t\t\t\t\t\t'rrui__slideout-menu--bottom'     : anchor === 'bottom',\r\n\t\t\t\t\t\t\t'rrui__slideout-menu--fullscreen' : fullscreen,\r\n\t\t\t\t\t\t\t'rrui__slideout-menu--expanded'   : show\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t) }>\r\n\t\t\t\t\t{ children }\r\n\t\t\t\t</div>\r\n\t\t\t</OnFocusOutOrTapOutside>\r\n\t\t)\r\n\t}\r\n}"]}