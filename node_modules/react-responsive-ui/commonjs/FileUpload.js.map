{"version":3,"sources":["../source/FileUpload.js"],"names":["PureComponent","Component","FileUpload","state","draggedOver","onClick","event","props","disabled","preventDefault","fileInput","click","onKeyDown","ctrlKey","altKey","shiftKey","metaKey","keyCode","setDraggedOver","setState","storeFileInputRef","ref","onFileInputChange","value","multiple","onChange","action","acceptedFiles","rejectedFiles","isAccepted","ref_","required","error","tabIndex","accept","ext","style","className","children","_accept","propTypes","func","bool","string","oneOfType","arrayOf","number","isRequired","node","object","defaultProps","forwardRef"],"mappings":"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","file":"FileUpload.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport classNames from 'classnames'\r\n\r\nimport { DropFiles } from './DragAndDrop'\r\nimport FileUploadInput, { getAcceptFromExt } from './FileUploadInput'\r\nimport WithError from './WithError'\r\n\r\nimport { submitFormOnCtrlEnter } from './utility/dom'\r\n\r\n// `PureComponent` is only available in React >= 15.3.0.\r\nconst PureComponent = React.PureComponent || React.Component\r\n\r\nclass FileUpload extends PureComponent\r\n{\r\n\tstatic propTypes =\r\n\t{\r\n\t\t// On file(s) chosen.\r\n\t\tonChange  : PropTypes.func,\r\n\r\n\t\t// (deprecated, use `onChange` instead).\r\n\t\t// On file(s) chosen.\r\n\t\taction    : PropTypes.func,\r\n\r\n\t\t// Allows choosing multiple files if `true`.\r\n\t\tmultiple  : PropTypes.bool,\r\n\r\n\t\t// Can be used to restrict the file MIME-types or extensions available for selection.\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file#attr-accept\r\n\t\taccept: PropTypes.string,\r\n\r\n\t\t// Will be transformed to `accept`.\r\n\t\text: PropTypes.oneOfType([\r\n\t\t\tPropTypes.arrayOf(PropTypes.string),\r\n\t\t\tPropTypes.string\r\n\t\t]),\r\n\r\n\t\t// Disables the file input.\r\n\t\tdisabled  : PropTypes.bool,\r\n\r\n\t\t// `onClick` handler.\r\n\t\tonClick   : PropTypes.func,\r\n\r\n\t\t// Whether choosing a file (or files) is required.\r\n\t\trequired : PropTypes.bool,\r\n\r\n\t\t// Indicates that the input is invalid.\r\n\t\terror : PropTypes.oneOfType([\r\n\t\t\tPropTypes.string,\r\n\t\t\tPropTypes.bool\r\n\t\t]),\r\n\r\n\t\ttabIndex  : PropTypes.number.isRequired,\r\n\r\n\t\t// The clickable area, like \"Click here to choose a file\".\r\n\t\tchildren  : PropTypes.node,\r\n\r\n\t\t// CSS class\r\n\t\tclassName : PropTypes.string,\r\n\r\n\t\t// CSS style object\r\n\t\tstyle     : PropTypes.object,\r\n\r\n\t\t// Deprecated.\r\n\t\t// Rewrite this component in hooks instead.\r\n\t\t// A hack for `React.forwardRef()`.\r\n\t\t// Could be rewritten in \"hooks\" instead.\r\n\t\t// A hack for providing `.focus()` method on `<DropFileUpload/>`.\r\n\t\tref_: PropTypes.object\r\n\t}\r\n\r\n\tstatic defaultProps =\r\n\t{\r\n\t\ttabIndex : 0\r\n\t}\r\n\r\n\tstate =\r\n\t{\r\n\t\tdraggedOver : false\r\n\t}\r\n\r\n\tonClick = (event) => {\r\n\t\tconst {\r\n\t\t\tdisabled,\r\n\t\t\tonClick\r\n\t\t} = this.props\r\n\t\tif (disabled) {\r\n\t\t\tif (event) {\r\n\t\t\t\tevent.preventDefault()\r\n\t\t\t}\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (onClick) {\r\n\t\t\tonClick()\r\n\t\t}\r\n\t\tthis.fileInput.click()\r\n\t}\r\n\r\n\tonKeyDown = (event) => {\r\n\t\tif (event.ctrlKey || event.altKey || event.shiftKey || event.metaKey) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tswitch (event.keyCode) {\r\n\t\t\t// \"Enter\".\r\n\t\t\tcase 13:\r\n\t\t\t// Spacebar.\r\n\t\t\tcase 32:\r\n\t\t\t\tevent.preventDefault()\r\n\t\t\t\t// Emulate `:active` on key press.\r\n\t\t\t\t// setTimeout(() => {\r\n\t\t\t\t// \tif (this._isMounted) {\r\n\t\t\t\t// \t\tthis.setState({\r\n\t\t\t\t// \t\t\tisActive: true\r\n\t\t\t\t// \t\t})\r\n\t\t\t\t// \t}\r\n\t\t\t\t// })\r\n\t\t\t\treturn this.onClick()\r\n\t\t}\r\n\t}\r\n\r\n\tsetDraggedOver = (draggedOver) => this.setState({ draggedOver })\r\n\r\n\tstoreFileInputRef = (ref) => this.fileInput = ref\r\n\r\n\tonFileInputChange = (value) => {\r\n\t\tconst { multiple } = this.props\r\n\t\t// `action` property is deprecated.\r\n\t\tconst onChange = this.props.onChange || this.props.action\r\n\t\tif (multiple) {\r\n\t\t\tonChange(value, {\r\n\t\t\t\tacceptedFiles: value,\r\n\t\t\t\trejectedFiles: []\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tonChange(value, {\r\n\t\t\t\tisAccepted: true\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tref_,\r\n\t\t\trequired,\r\n\t\t\terror,\r\n\t\t\tdisabled,\r\n\t\t\ttabIndex,\r\n\t\t\tonChange,\r\n\t\t\tmultiple,\r\n\t\t\taccept,\r\n\t\t\text,\r\n\t\t\tstyle,\r\n\t\t\tclassName,\r\n\t\t\tchildren\r\n\t\t} = this.props\r\n\r\n\t\tconst { draggedOver } = this.state\r\n\r\n\t\tconst _accept = accept || (ext && getAcceptFromExt(ext))\r\n\r\n\t\treturn (\r\n\t\t\t<WithError\r\n\t\t\t\terror={error}\r\n\t\t\t\tstyle={style}\r\n\t\t\t\tclassName={classNames('rrui__file-upload', className)}>\r\n\r\n\t\t\t\t{/* Hidden. */}\r\n\t\t\t\t{/* \"action\" property is deprecated. */}\r\n\t\t\t\t<FileUploadInput\r\n\t\t\t\t\tref={ this.storeFileInputRef }\r\n\t\t\t\t\tmultiple={ multiple }\r\n\t\t\t\t\tonChange={ this.onFileInputChange }\r\n\t\t\t\t\terror={ error }\r\n\t\t\t\t\trequired={ required }\r\n\t\t\t\t\tdisabled={ disabled }\r\n\t\t\t\t\taccept={ _accept }\r\n\t\t\t\t\taria-label={ this.props['aria-label'] }/>\r\n\r\n\t\t\t\t<DropFiles\r\n\t\t\t\t\tref={ref_}\r\n\t\t\t\t\trole=\"button\"\r\n\t\t\t\t\ttabIndex={ tabIndex }\r\n\t\t\t\t\taria-label={ this.props['aria-label'] }\r\n\t\t\t\t\taccept={ _accept }\r\n\t\t\t\t\tmultiple={ multiple }\r\n\t\t\t\t\tonDrop={ onChange }\r\n\t\t\t\t\tonClick={ this.onClick }\r\n\t\t\t\t\tonKeyDown={ this.onKeyDown }\r\n\t\t\t\t\tsetDraggedOver={ this.setDraggedOver }\r\n\t\t\t\t\tclassName={ classNames(\r\n\t\t\t\t\t\t/* Developers should define `:focus` styles for `<FileUpload/>`s. */\r\n\t\t\t\t\t\t'rrui__outline',\r\n\t\t\t\t\t\t'rrui__file-upload__area',\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t'rrui__file-upload__area--disabled' : disabled,\r\n\t\t\t\t\t\t\t'rrui__file-upload__area--invalid' : error,\r\n\t\t\t\t\t\t\t'rrui__file-upload__area--dragged-over' : draggedOver\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t) }>\r\n\t\t\t\t\t{ children }\r\n\t\t\t\t</DropFiles>\r\n\t\t\t</WithError>\r\n\t\t)\r\n\t}\r\n}\r\n\r\n// A hack for providing `.focus()` method on `<DropFileUpload/>`.\r\nexport default React.forwardRef((props, ref) => (\r\n\t<FileUpload ref_={ref} {...props}/>\r\n))"]}