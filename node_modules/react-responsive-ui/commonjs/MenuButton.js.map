{"version":3,"sources":["../source/MenuButton.js"],"names":["PureComponent","Component","ContextAwareMenuButton","props","context","registerMenuButton","toggleMenu","menuIsExpanded","MenuButton","onClick","event","preventDefault","cooldown","setCooldown","cooldownTimer","setTimeout","storeButtonNode","node","button","unregister","element","clearTimeout","link","className","MenuButtonIcon","icon","rest","properties","ref","children","createElement","href","type","propTypes","func","isRequired","bool","string","title","style","object","defaultProps"],"mappings":"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","file":"MenuButton.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport classNames from 'classnames'\r\n\r\nimport { Context } from './PageAndMenu'\r\nimport MenuIcon from './MenuIcon'\r\n\r\n// `PureComponent` is only available in React >= 15.3.0.\r\nconst PureComponent = React.PureComponent || React.Component\r\n\r\nconst ContextAwareMenuButton = (props) => (\r\n\t<Context.Consumer>\r\n\t\t{(context) => (\r\n\t\t\t<MenuButton\r\n\t\t\t\t{...props}\r\n\t\t\t\tregisterMenuButton={context.registerMenuButton}\r\n\t\t\t\ttoggleMenu={context.toggleMenu}\r\n\t\t\t\tmenuIsExpanded={context.menuIsExpanded}/>\r\n\t\t)}\r\n\t</Context.Consumer>\r\n)\r\n\r\nexport default ContextAwareMenuButton\r\n\r\nclass MenuButton extends PureComponent {\r\n\tstatic propTypes = {\r\n\t\t// Context.\r\n\t\tregisterMenuButton : PropTypes.func.isRequired,\r\n\t\ttoggleMenu : PropTypes.func.isRequired,\r\n\t\tmenuIsExpanded : PropTypes.bool, //.isRequired,\r\n\r\n\t\t// A URL of the \"Menu\" page:\r\n\t\t// if a web browser has javascript disabled (e.g. Tor),\r\n\t\t// then the menu button will redirect to this Menu page URL.\r\n\t\t// If not set then won't redirect anywhere.\r\n\t\tlink        : PropTypes.string,\r\n\r\n\t\t// HTML `title` attribute.\r\n\t\ttitle       : PropTypes.string,\r\n\r\n\t\t// Menu button icon component.\r\n\t\ticon        : PropTypes.func.isRequired,\r\n\r\n\t\t// CSS class.\r\n\t\tclassName   : PropTypes.string,\r\n\r\n\t\t// CSS style object.\r\n\t\tstyle       : PropTypes.object\r\n\t}\r\n\r\n\tstatic defaultProps = {\r\n\t\ticon : MenuIcon\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst { registerMenuButton } = this.props\r\n\t\tthis.unregister = registerMenuButton({\r\n\t\t\telement: () => this.button,\r\n\t\t\tsetCooldown: this.setCooldown\r\n\t\t})\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.unregister()\r\n\t\tclearTimeout(this.cooldownTimer)\r\n\t}\r\n\r\n\tonClick = (event) => {\r\n\t\tevent.preventDefault()\r\n\t\tconst { toggleMenu } = this.props\r\n\t\t// A workaround for Safari (both macOS and iOS) bug: `<button/>`s not getting focus.\r\n\t\t// https://stackoverflow.com/questions/20359962/jquery-mobile-focusout-event-for-relatedtarget-returns-incorrect-result-in-safar\r\n\t\tif (!this.cooldown) {\r\n\t\t\ttoggleMenu()\r\n\t\t}\r\n\t}\r\n\r\n\tsetCooldown = () => {\r\n\t\t// A workaround for Safari (both macOS and iOS) bug: `<button/>`s not getting focus.\r\n\t\t// https://stackoverflow.com/questions/20359962/jquery-mobile-focusout-event-for-relatedtarget-returns-incorrect-result-in-safar\r\n\t\t// Sets a small \"cooldown\" on hide on focus out.\r\n\t\tthis.cooldown = true\r\n\t\tthis.cooldownTimer = setTimeout(() => this.cooldown = false, 30)\r\n\t}\r\n\r\n\tstoreButtonNode = (node) => this.button = node\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tlink,\r\n\t\t\tclassName,\r\n\t\t\ticon: MenuButtonIcon,\r\n\t\t\tmenuIsExpanded,\r\n\r\n\t\t\t// Getting \"rest\" properties.\r\n\t\t\ttoggleMenu,\r\n\t\t\tregisterMenuButton,\r\n\t\t\t...rest\r\n\t\t} = this.props\r\n\r\n\t\tconst properties = {\r\n\t\t\tref: this.storeButtonNode,\r\n\t\t\tonClick: this.onClick,\r\n\t\t\t// 'aria-label': 'Menu',\r\n\t\t\t// 'aria-haspopup': 'menu',\r\n\t\t\t'aria-expanded': menuIsExpanded ? true : false, // can be `undefined` to differentiate between \"has been toggled yet\"/\"has not been toggled yet\" to workaround the CSS animation bug.\r\n\t\t\tclassName: classNames('rrui__button-reset', 'rrui__outline', 'rrui__menu-button', className),\r\n\t\t\t...rest\r\n\t\t}\r\n\r\n\t\tconst children = <MenuButtonIcon expanded={menuIsExpanded}/>\r\n\r\n\t\t// A link.\r\n\t\tif (link) {\r\n\t\t\treturn React.createElement(\r\n\t\t\t\t'a',\r\n\t\t\t\t{\r\n\t\t\t\t\t...properties,\r\n\t\t\t\t\thref: link\r\n\t\t\t\t},\r\n\t\t\t\tchildren\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\t// A button.\r\n\t\treturn React.createElement(\r\n\t\t\t'button',\r\n\t\t\t{\r\n\t\t\t\t...properties,\r\n\t\t\t\ttype: 'button'\r\n\t\t\t},\r\n\t\t\tchildren\r\n\t\t)\r\n\t}\r\n}"]}